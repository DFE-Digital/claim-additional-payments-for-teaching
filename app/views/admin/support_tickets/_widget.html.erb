<% if support_ticket.persisted? %>
  <h2 class="govuk-heading-m">Support ticket</h2>

  <ul class="govuk-body">
    <%# EY journey without a practitioner will not have an email address yet %>
    <% if @claim.email_address %>
      <li><%= govuk_link_to "View all support tickets in Zendesk", zendesk_email_search_url(@claim.email_address), new_tab: "" %></li>
    <% end %>
    <li><%= govuk_link_to claim.support_ticket.url, claim.support_ticket.url, new_tab: ""  %></li>
  </ul>
<% else %>
  <%= form_with model: [:admin, claim, support_ticket], builder: GOVUKDesignSystemFormBuilder::FormBuilder do |f| %>
    <%= f.govuk_text_field :url,
      label: {
        text: "Support ticket",
        tag: "h2",
        size: "m"
      },
      hint: -> do %>
        <% if @claim.email_address %>
          <p class="govuk-body-m">
            <%= govuk_link_to "View all support tickets in Zendesk", zendesk_email_search_url(@claim.email_address) , new_tab: "" %>
          </p>
        <% end %>
        Create a ticket on Zendesk and enter the URL here.
      <% end %>

    <%= f.govuk_submit "Save support ticket" %>
  <% end %>
<% end %>
