<% content_for(:page_title, page_title(t("questions.home_address"), policy: current_policy_routing_name, show_error: current_claim.errors.any?)) %>

<div class="govuk-grid-row">
  <div class="govuk-grid-column-two-thirds">
    <%= render("shared/error_summary", instance: current_claim) if current_claim.errors.any? %>

    <%= form_for current_claim, url: claim_path(current_policy_routing_name) do |form| %>
      <div class="govuk-!-margin-bottom-5">
        <h1 class="govuk-heading-xl"><%= t("questions.home_address") %></h1>
        <h2 class="govuk-heading-l govuk-!-margin-bottom-1">Postcode</h2>
      </div>

      <%= form_group_tag current_claim do %>
        <fieldset class="govuk-fieldset" aria-describedby="address-search-result-hint">
          <legend class="govuk-fieldset__legend govuk-fieldset__legend--l">
            <h2 class="govuk-fieldset__heading govuk-!-margin-top-3">
              Select an address
            </h2>
          </legend>
          <div class="govuk-radios">
            <% @address_data.each do |option| %>
              <% address = option[:address].gsub(",", "").gsub(" ", "_").downcase %>
              <% checked = params.dig(:claim, :address_line_1) == option[:address_line_1] %>

              <div class="govuk-radios__item">
                <%= radio_button_tag :address, [option[:address], option[:address_line_1]].join(":"), checked, class: "govuk-radios__input", id: address %>
                <%= label_tag address, "#{option[:address]}", class: "govuk-label govuk-radios__label", id: address %>
              </div>
            <% end %>
          </div>
        </fieldset>
      <% end %>
      <%= form.submit "Continue", class: "govuk-button" %>
    <% end %>
  </div>
</div>
